import{j as s}from"./jsx-runtime.D_zvdyIk.js";import{r as i}from"./index.BVOCwoKb.js";import{a as x}from"./api.5Q3dkJYY.js";function h(){const[d,f]=i.useState(null),[g,l]=i.useState(!1),[b,r]=i.useState("");return i.useEffect(()=>{x.loadToken()},[]),{user:d,loading:g,error:b,login:async(t,o)=>{const m={email:t,password:o};l(!0),r("");try{const e=await x.login(m);return e.success?(f(e.user),{success:!0,user:e.user}):(r(e.message||"Error en el login"),{success:!1,error:e.message})}catch(e){let n="Error de conexión";return e instanceof Error&&(n+=": "+e.message),r(n),{success:!1,error:n}}finally{l(!1)}},logout:async()=>{try{await x.logout()}catch(t){console.error("Error en logout:",t)}finally{f(null),r("")}},register:async t=>{l(!0),r("");try{const o=await x.register(t);return o.success?{success:!0,message:o.message}:(r(o.message||"Error en el registro"),{success:!1,error:o.message})}catch(o){const m="Error de conexión: "+(o instanceof Error?o.message:"Error desconocido");return r(m),{success:!1,error:m}}finally{l(!1)}},isAuthenticated:!!d}}const j=()=>{const[d,f]=i.useState(""),[g,l]=i.useState(""),[b,r]=i.useState(""),[y,u]=i.useState(""),[p,t]=i.useState(!1),{login:o}=h(),m=async e=>{if(e.preventDefault(),r(""),u(""),t(!0),!d||!g){r("Por favor, complete todos los campos."),u("error"),t(!1);return}try{const n=await o(d,g);n.success?(r("Inicio de sesión exitoso!"),u("success"),f(""),l(""),setTimeout(()=>{window.location.href="/dashboard"},1e3)):(r(n.error||"Error al iniciar sesión."),u("error"))}catch(n){let c="Error al iniciar sesión.";if(n instanceof Error){const a=n.message;a.includes("401")||a.includes("Unauthorized")?c="Credenciales incorrectas. Verifique su email y contraseña.":a.includes("403")||a.includes("Forbidden")?c="Acceso denegado. Su cuenta podría no estar activa.":a.includes("500")||a.includes("Internal Server Error")?c="Error del servidor. Inténtalo de nuevo más tarde.":a.includes("Network")||a.includes("fetch")?c="No se pudo conectar con el servidor. Verifique su conexión.":c=a||"Error inesperado. Inténtalo de nuevo."}else c="Error inesperado. Inténtalo de nuevo.";r(c),u("error")}finally{t(!1)}};return s.jsxs("form",{onSubmit:m,className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Email"}),s.jsx("input",{type:"email",id:"email",className:"block w-full px-3 py-2 mt-1 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:border-transparent sm:text-sm",style:{"--tw-ring-color":"#ff7b00"},value:d,onChange:e=>f(e.target.value),disabled:p,required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"Contraseña"}),s.jsx("input",{type:"password",id:"password",className:"block w-full px-3 py-2 mt-1 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:border-transparent sm:text-sm",style:{"--tw-ring-color":"#ff7b00"},value:g,onChange:e=>l(e.target.value),disabled:p,required:!0})]}),b&&s.jsx("div",{className:`p-3 rounded-md text-sm ${y==="error"?"bg-red-100 text-red-700 border border-red-200":"bg-green-100 text-green-700 border border-green-200"}`,children:b}),s.jsx("div",{children:s.jsx("button",{type:"submit",disabled:p,className:"flex justify-center w-full px-4 py-2 text-sm font-medium text-white border border-transparent rounded-md shadow-sm hover:opacity-90 focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed transition-all",style:{backgroundColor:"#ff7b00","--tw-ring-color":"#ff7b00"},children:p?s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"w-4 h-4 mr-2 border-b-2 border-white rounded-full animate-spin"}),"Iniciando sesión..."]}):"Iniciar Sesión"})})]})};export{j as default};
